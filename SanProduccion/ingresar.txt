<?php
// Conexión a la base de datos (configura tus credenciales)
$servername = "localhost";
$username = "root";
$password = "";
$database = "snb";

$conn = new mysqli($servername, $username, $password, $database);

// Verificar la conexión
if ($conn->connect_error) {
    die("Error de conexión: " . $conn->connect_error);
}

// Función para eliminar un registro de insumo
if (isset($_GET['eliminar'])) {
    $idInsumo = $_GET['eliminar'];
    $sql = "DELETE FROM insumos WHERE id = ?";
    $stmt = $conn->prepare($sql);
    $stmt->bind_param("i", $idInsumo);
    if ($stmt->execute()) {
        header("Location: " . $_SERVER['PHP_SELF']);
    } else {
        echo "Error al eliminar el registro de insumo: " . $stmt->error;
    }
    $stmt->close();
}

// Consulta SQL para obtener los registros de insumos
$sql = "SELECT id, tipoInsumos, cantidadInsumos, fechaInsumos FROM insumos";
$result = $conn->query($sql);

?>

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ... -->
</head>
<body>
    <!-- ... -->
    <section class="main">
        <h2>Registrar Insumos</h2>
        <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">
            <!-- ... -->
        </form>
        
        <h2>Lista de Insumos</h2>
        <table>
            <tr>
                <th>Tipo de Insumo</th>
                <th>Cantidad</th>
                <th>Fecha de Entrada</th>
                <th>Acciones</th>
            </tr>
            <?php
            // Mostrar los registros de insumos en una tabla
            while ($row = $result->fetch_assoc()) {
                echo "<tr>";
                echo "<td>" . $row['tipoInsumos'] . "</td>";
                echo "<td>" . $row['cantidadInsumos'] . "</td>";
                echo "<td>" . $row['fechaInsumos'] . "</td>";
                echo "<td>";
                echo "<a href='" . $_SERVER['PHP_SELF'] . "?eliminar=" . $row['id'] . "'>Eliminar</a>";
                echo " | ";
                echo "<a href='editar_insumo.php?id=" . $row['id'] . "'>Editar</a>"; // Enlazar a la página de edición
                echo "</td>";
                echo "</tr>";
            }
            ?>
        </table>
    </section>
</body>
</html>

